container:
  image: ubuntu:focal

task:
  environment:
    LANG: C.UTF-8

  build_script:
    - export LANG=C.UTF-8
    - apt-get update
    - apt-get install -y autoconf automake libtool g++ make python3
    - apt-get install -y parallel libpcre2-dev
    - ./ci/build.sh
    - ./check_includes.sh
    - python3 ci/cirrus_irc-notify.py mcfproj "[ lh_mouse {repo_name}#{short_commit}] passed on {branch} by {author} ({build_url})"

  on_failure:
    failure_script: python3 ci/cirrus_irc-notify.py mcfproj "[ lh_mouse {repo_name}#{short_commit}] errored on {branch} by {author} ({build_url})"
